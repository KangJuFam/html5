
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê³ ì–‘ì´ vs. ë§¤í™”ê²€</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: black;
        }
        canvas {
            display: block;
            background-color: #f0f0f0;
        }
    </style>
</head>
<body>
	<div id="score" style="position: absolute; top: 10px; left: 10px; font-size: 24px; color: black; font-weight: bold; background-color: rgba(255, 255, 255, 0.7); padding: 5px; border-radius: 5px;">
		ìƒì¡´ ì‹œê°„: 0ì´ˆ
	</div>
    <canvas id="gameCanvas"></canvas>
    <script>
	    
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");
    	canvas.width = window.innerWidth;
    	canvas.height = window.innerHeight;
	function startGame() {	    
	let catX = canvas.width / 2 - 12.5;
	let catY = canvas.height / 2 - 12.5;

	let speed = 5;
	let keys = {};
	
	let isDragging = false;

	let swords = [];
	let gameTime = 0;
	
	let spawnRate = 1000; // ì´ˆê¸° ê²€ê¸° ìƒì„± ì£¼ê¸° (1ì´ˆ)
	let additionalSwords = 0; // ì¶”ê°€ ìƒì„±í•  ê²€ê¸° ê°œìˆ˜

	let isGameOver = false;
	    
	window.addEventListener("keydown", (event) => {
		keys[event.key] = true;
	});

	window.addEventListener("keyup", (event) => {
		keys[event.key] = false;
	});
	
	canvas.addEventListener("mousedown", (event) => {
		if (
		    event.clientX >= catX &&
		    event.clientX <= catX + 25 &&
		    event.clientY >= catY &&
		    event.clientY <= catY + 25
		  ) {
		    isDragging = true;
		  }
	});
	
	canvas.addEventListener("mousemove", (event) => {
		if (isDragging) {
			catX = event.clientX - 12.5;
			catY = event.clientY - 12.5;
		}
	});
	
	canvas.addEventListener("mouseup", () => {
		isDragging = false;
	});

	canvas.addEventListener("touchmove", (event) => {
		let touch = event.touches[0];
		catX = touch.clientX - 12.5;
		catY = touch.clientY - 12.5;
	});
		
		function moveCat() {
			if (keys["ArrowLeft"] && catX > 0) catX -= speed;
			if (keys["ArrowRight"] && catX < canvas.width - 25) catX += speed;
			if (keys["ArrowUp"] && catY > 0) catY -= speed;
			if (keys["ArrowDown"] && catY < canvas.height - 25) catY += speed;
		}
		
		function createSword() {
			let side = Math.floor(Math.random() * 4);
			let x, y;

			if (side === 0) {
				x = Math.random() * canvas.width;
				y = -5;
			} else if (side === 1) {
				x = Math.random() * canvas.width;
				y = canvas.height + 5;
			} else if (side === 2) {
				x = -5;
				y = Math.random() * canvas.height;
			} else {
				x = canvas.width + 5;
				y = Math.random() * canvas.height;
			}

			let angle = Math.atan2(catY + 12.5 - y, catX + 12.5 - x);
			let acceleration = gameTime > 30 ? 0.2 : 0.1; // 30ì´ˆ ì´í›„ ê°€ì†ë„ ì¦ê°€
			let speed = Math.min(2 + gameTime * acceleration, 10); // ìµœëŒ€ ì†ë„ 10 ì œí•œ

			swords.push({ x, y, angle, speed });
		}

		function updateSwords() {
			swords = swords.filter(sword => {
				sword.x += Math.cos(sword.angle) * sword.speed;
				sword.y += Math.sin(sword.angle) * sword.speed;

				return sword.x >= -5 && sword.x <= canvas.width + 5 &&
					   sword.y >= -5 && sword.y <= canvas.height + 5;
			});
		}

		function drawSwords() {
			ctx.font = "15px sans-serif";
			ctx.textAlign = "center";
			ctx.textBaseline = "middle";
			swords.forEach(sword => {
			  ctx.fillText("ğŸŒ¸", sword.x, sword.y);
			});
		}
		
		function checkCollision() {
			swords.forEach(sword => {
				let dx = sword.x - (catX + 12.5);
				let dy = sword.y - (catY + 12.5);
				let distance = Math.sqrt(dx * dx + dy * dy);
				
				if (distance < 18) { // ê³ ì–‘ì´ í¬ê¸° + ê²€ê¸° í¬ê¸° ê³ ë ¤
					
					if (!isGameOver) {
						isGameOver = true;
						setTimeout(() => {
							gameOver();
						}, 100);
					}
				}
			});
		}

		function gameOver() {
			let title = getTitle(gameTime);
			alert("ê²Œì„ ì˜¤ë²„! ğŸ±ğŸ’€\nì¹­í˜¸: " + title + "\nìƒì¡´ ì‹œê°„: " + gameTime + "ì´ˆ");
			location.reload(); // ê²Œì„ ìƒˆë¡œê³ ì¹¨
		}
		
		function updateScore() {
			document.getElementById("score").innerText = "ìƒì¡´ ì‹œê°„: " + gameTime + "ì´ˆ";
		}
		
		function getTitle(time) {
			if (time < 20) return "ì´ˆë³´ ê³ ì–‘ì´";
			if (time < 40) return "ê³ ì–‘ì´ í˜‘ê°";
			if (time < 60) return "ë§¤í™”ê²€ì˜ ë‹¬ì¸";
			return "ì „ì„¤ì˜ ë¬´ë¦¼ë¬˜";
		}

        function gameLoop() {
			if (isGameOver) return; // ê²Œì„ ì˜¤ë²„ ì‹œ draw() ì¤‘ë‹¨
			
            ctx.clearRect(0, 0, canvas.width, canvas.height);
			moveCat();
			updateSwords();
			drawSwords();
			checkCollision();
			updateScore();
			
			ctx.font = "25px sans-serif";
			ctx.textAlign = "center";
			ctx.textBaseline = "middle";
			ctx.fillText("ğŸ±", catX + 12.5, catY + 12.5);
			requestAnimationFrame(gameLoop);
        }

        gameLoop();
		
		setInterval(() => {
			gameTime += 1;
			createSword();
			
			// 5ì´ˆë§ˆë‹¤ ê²€ê¸° ìƒì„± ê°„ê²© ê°ì†Œ, ì¶”ê°€ ê²€ê¸° ê°œìˆ˜ ì¦ê°€
			if (gameTime % 5 === 0) {
				spawnRate = Math.max(spawnRate - 100, 300);
				additionalSwords = Math.min(additionalSwords + 5, 100);
			}
			
			for (let i = 0; i < additionalSwords; i++) {
				createSword();
			}        
		}, spawnRate);

	    }
    const checkCanvasSize = setInterval(() => {
	    
    	canvas.width = window.innerWidth;
    	canvas.height = window.innerHeight;
      if (canvas.width >= 400 && canvas.height >= 400) {
        clearInterval(checkCanvasSize);
        startGame();
      }
    }, 100);
    </script>
</body>
</html>
